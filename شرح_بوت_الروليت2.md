شرح تفصيلي ومنظم لبوت التليجرام
يرجى استخدام نمط البرمجه الكائنيه في طريقه كتابه اكواد البوت
يرجى مراعاة معايير OOP
يرجى استخدام قاعدة بيانات PostgreSQL بشكل علائقي  ودقيق جدا وقابل للتطوير والاضافات المستقبليع

شرح وضائف البوت:
1. تفعيل الاشتراك الإجباري وبدء استخدام البوت

آلية التحقق من الاشتراك:

· عند تفعيل خاصية الاشتراك الإجباري، وعندما يرسل المستخدم أمر /start للبوت:
  1. يقوم البوت بالتحقق مما إذا كان المستخدم مشتركًا في قناة الاشتراك الإجباري المحددة.
  2. إذا لم يكن المستخدم مشتركًا:
     · يظهر له رسالة تطلب منه الاشتراك أولاً.
     · تحت الرسالة يوجد زرين:
       · زر "اضغط للاشتراك": عند الضغط عليه، يتم توجيه المستخدم إلى قناة الاشتراك الإجباري.
       · زر "لقد اشتركت": عند الضغط عليه، يعيد البوت التحقق من اشتراك المستخدم.
  3. بعد التحقق الناجح من الاشتراك:
     · تظهر للمستخدم لوحة الأزرار الرئيسية الخاصة بالمستخدمين.

---

2. الأزرار الرئيسية للمستخدمين

بعد التحقق من الاشتراك، تظهر الأزرار التالية:

1. زر قسم الروليت
2. زر قسم مسابقات التصويت
3. زر مسابقة "يستحق"
4. زر قسم مسابقة الأسئلة
5. زر قسم إدارة المجموعات أو القنوات المضافة
6. زر قسم إدارة الاشتراك
7. زر قسم إدارة سحوباتي ومسابقاتي
8. زر قسم كسب النقاط

---

3. شرح مفصل لكل قسم

3.1. قسم الروليت

3.1.1. إنشاء روليت عادي:

· تحديد المجموعة/القناة:
  · إذا كان المستخدم قد أضاف قنوات/مجموعات مسبقًا (عبر القسم 5)، تظهر قائمة بأسمائها كأزرار شفافة + زر "إضافة قناة/مجموعة جديدة".
  · إذا لم يضف أي قناة/مجموعة مسبقًا، يطلب البوت:
    1. رفع البوت (الرئيسي أو المساعد) مشرفًا في القناة/المجموعة.
    2. إرسال رابط القناة/المجموعة للبوت.
· تحديد شرط السحب (اختياري):
  · تظهر أزرار شفافة للشروط التالية، مع زر "تخطي":
    1. قناة الشرط:
       · يطلب إضافة البوت مشرفًا في القناة ثم إرسال رابطها.
       · يجب على المشاركين الاشتراك في هذه القناة.
    2. مجموعة الشرط:
       · يطلب إضافة البوت مشرفًا في المجموعة ثم إرسال رابطها.
       · يجب على المشاركين الاشتراك في هذه المجموعة.
    3. تصويت لمتسابق:
       · يطلب إرسال رمز التصويت الخاص بالمتسابق (يشرح في قسم مسابقات التصويت).
       · يجب أن يكون البوت مشرفًا في القناة/المجموعة التي تحتوي مسابقة التصويت.
    4. التعليق على منشور:
       · يطلب إرسال رمز المنشور الخاص بالمتسابق (يشرح في قسم "يستحق").
       · يجب أن يكون البوت مشرفًا في القناة والمجموعة التي تحتوي مسابقة "يستحق".
    5. الاشتراك في روليت آخر:
       · يطلب إرسال رمز الروليت الآخر.
       · يجب أن يكون البوت مشرفًا في القناة/المجموعة التي تحتوي الروليت الآخر، وأن يكون البوت هو من يدير ذلك الروليت.
· كتابة كليشة السحب:
  · يطلب البوت إرسال نص كليشة السحب.
  · يمكن استخدام تنسيقات تليجرام مباشرة (عريض، مائل، مشطوب، مقتبس) دون الحاجة لرموز خاصة.
· تحديد عدد الفائزين:
  · بعد إرسال الكليشة، يطلب البوت تحديد عدد الفائزين.
· تخصيص المسابقة:
  بعد تحديد عدد الفائزين، تظهر أزرار التخصيص:
  1. زر نوع المستخدمين:
     · اختيار بين: جميع المستخدمين / المستخدمين المميزين فقط (حسابات Premium).
     · الإعداد الافتراضي: متاح للجميع.
  2. زر تعطيل الاشتراك في قناة المسابقة:
     · إذا عُطِّل، لن يطلب البوت من المشاركين الاشتراك في قناة السحب.
     · الإعداد الافتراضي: مفعل (يطلب الاشتراك).
  3. زر منع الوهمي:
     · ينشئ اختبار تحقق للمستخدمين لمنع الحسابات الآلية (الروبوتات).
     · الإعداد الافتراضي: مفعل.
  4. زر استبعاد المغادرين:
     · يستبعد المشاركين الذين يغادرون قناة/مجموعة السحب عند إجراء القرعة.
     · الإعداد الافتراضي: مفعل.
  5. زر التأكيد وبدء السحب:
     · عند الضغط:
       · ينشئ البوت رمزًا خاصًا لهذا السحب (يمكن استخدامه كشرط في روليت آخر).
       · ينشر كليشة السحب في القناة/المجموعة المحددة بنفس التنسيق.
       · تحت الكليشة تظهر 3 أزرار شفافة:
         · زر عدد المشتركين: يظهر العدد الحالي.
         · زر مشاركة السحب: ينشئ كليشة أونلاين قابلة للمشاركة في أي مكان في تليجرام، مع زر يوجه لمنشور السحب الأصلي.
         · زر الاشتراك في السحب: (آلية عمل هذا الزر موضحة أدناه).

3.1.2. آلية اشتراك المستخدمين في السحب:

· عند ضغط المستخدم على زر الاشتراك في السحب:
  1. التحقق من الاشتراك في القناة/المجموعة (إذا لم يكن معطلًا):
     · إذا لم يكن مشتركًا، تظهر رسالة منبثقة تطلب الاشتراك أولاً.
  2. التوجيه إلى خاص البوت:
     · بعد الاشتراك، يتم توجيهه إلى خاص البوت.
  3. اختبار التحقق من الوهمي (إذا كان مفعلًا):
     · يجري البوت اختبارًا للتأكد من أن الحساب حقيقي وليس روبوت.
  4. تنفيذ الشروط (إذا وجدت):
     · يطلب البوت من المستخدم تنفيذ الشرط (انضمام لقناة/مجموعة، تصويت، تعليق، اشتراك في روليت آخر).
  5. تأكيد الاشتراك:
     · بعد إتمام الخطوات، يُضاف المستخدم إلى قائمة المشاركين.
     · يُخبر بأنه سيصله إشعار إذا فاز، ويطلب منه عدم مغادرة القناة/المجموعة (إذا كان استبعاد المغادرين مفعلًا).

3.1.3. حالة السحب للمستخدمين المميزين فقط:

· إذا كان السحب مخصصًا للمستخدمين المميزين (Premium) فقط:
  · يحاول المستخدم العادي الاشتراك ← تظهر له رسالة منبثقة تفيد أن السحب مخصص للمستخدمين المميزين.

---

3.2. قسم مسابقات التصويت

3.2.1. مسابقة تصويت عادي:

· تحديد القناة/المجموعة:
  · نفس آلية قسم الروليت (عرض القنوات المضافة مسبقًا أو طلب إضافة جديدة).
· إرسال كليشة المسابقة:
  · بعد تحديد المكان، يطلب البوت إرسال نص كليشة المسابقة.
· تخصيص المسابقة:
  · تظهر نفس أزرار تخصيص الروليت، مع إضافة:
    · زر منع التصويت المتعدد: إذا فُعِّل، يمنع المستخدم من التصويت لأكثر من متسابق.
· زر التأكيد وبدء المسابقة:
  · ينشر البوت الكليشة في القناة/المجموعة المحددة، مع 3 أزرار شفافة (مشابهة للروليت).

3.2.2. آلية المشاركة في مسابقة التصويت:

· للمتسابقين:
  1. الضغط على زر الاشتراك في المسابقة ← التوجيه إلى خاص البوت.
  2. يطلب البوت: إرسال اسم المتسابق أو استخدام اسم الحساب عبر زر "استخدم اسم حسابي".
  3. بعد تحديد الاسم:
     · ينشر البوت رسالة جديدة في القناة تحتوي على اسم المتسابق وزر يظهر عدد المصوتين (❤️).
     · يرسل البوت للمتسابق رابط رسالته في القناة ورمز التصويت الخاص به (يمكن استخدامه كشرط في روليت آخر).
· للمصوتين:
  1. الضغط على زر التصويت تحت اسم المتسابق.
  2. التحقق من الاشتراك في القناة/المجموعة (إذا لم يُعطّل).
  3. التوجيه إلى خاص البوت وإجراء اختبار التحقق من الوهمي (إذا كان مفعلًا).
  4. بعد الإتمام، يُحتسب تصويت المستخدم للمتسابق.
· ملاحظة: لا يمكن للمستخدم التصويت أكثر من مرة لنفس المتسابق إلا إذا عطّل منشئ المسابقة هذا الخيار.

3.2.3. مسابقة تصويت نجوم:

· شرط الاستخدام: يجب أن يكون المستخدم مشتركًا في البوت (اشتراك شهري أو لمرة واحدة).
· الآلية: نفس مسابقة التصويت العادي، مع الاختلافات التالية:
  · يتم التصويت بدفع نجوم.
  · يظهر زر التصويت بعدد النجوم للمتسابق (⭐️).
  · عند الضغط على زر التصويت:
    1. نفس إجراءات التصويت العادي في خاص البوت.
    2. يطلب البوت من المصوت إدخال عدد النجوم المراد إضافتها للمتسابق.
    3. ينشئ البوت فاتورة دفع بهذا العدد.
    4. بعد دفع المستخدم، يتم تحديث عدد النجوم للمتسابق في قناة المسابقة.
  · يسمح للمصوتين التصويت لأكثر من متسابق.

3.2.4. مسابقة تصويت عادي + نجوم:

· شرط الاستخدام: نفس شرط مسابقة النجوم (اشتراك في البوت).
· الآلية: تجمع بين التصويت العادي والتصويت بالنجوم.
  · يظهر تحت اسم المتسابق زرين:
    · زر تصويت عادي.
    · زر تصويت نجوم.
  · يسمح للمصوتين التصويت بنجوم لأكثر من متسابق.
  · زر إضافي في التخصيص: "تحديد قيمة التصويت بنجوم" – يحدد منشئ المسابقة قيمة النجم الواحد بعدد التصويتات العادية.
    · القيمة الافتراضية: النجم الواحد = 2 تصويت عادي.

3.2.5. إنهاء المسابقة وحساب النجوم:

· عند إنهاء المسابقة وإعلان الفائزين (إذا كانت تتضمن تصويتًا بالنجوم):
  · يحسب البوت العدد الإجمالي للنجوم المكتسبة من المسابقة كاملة.
  · ينشئ فاتورة برمز فريد ويخبر منشئ المسابقة بأنه يمكنه تحويل هذه الفاتورة لمالك البوت لدفع قيمة النجوم.

---

3.3. قسم مسابقة "يستحق"

· تحديد القناة:
  · تظهر قائمة بالقنوات المضافة (كأزرار شفافة) أو طلب إضافة قناة جديدة.
· ربط المجموعة:
  · يطلب رفع البوت مشرفًا في المجموعة التابعة للقناة وإرسال رابطها.
· إرسال كليشة المسابقة:
  · بعد الربط، يطلب إرسال نص كليشة المسابقة.
· تخصيص المسابقة:
  · تظهر أزرار التخصيص (كما في قسم التصويت) وزر التأكيد والبدء.
· زر التأكيد والبدء:
  · ينشر البوت الكليشة في القناة مع 3 أزرار شفافة (كما في الأقسام السابقة).

آلية مسابقة "يستحق":

· للمتسابقين: نفس آلية مسابقة التصويت (اختيار الاسم، نشر رسالة، استلام الرابط والرمز).
· للمصوتين:
  1. الضغط على زر التصويت ← التحقق من الاشتراك ← التوجيه إلى خاص البوت ← اختبار التحقق (إذا كان مفعلًا).
  2. يخبر البوت المصوت بأن يقوم بكتابة:
     · "يستحق" فقط، أو
     · "يستحق + اسم المتسابق"
       في المجموعة المحددة.
  3. يعرض البوت نصين قابليْن للنسخ (مثال: "يستحق" / "يستحق خيال") ويطلب نسخ أحدهما وإرساله للمجموعة.
  4. عندما يكتب المصوت "يستحق" في المجموعة:
     · يرد البوت في المجموعة بتأكيد احتساب التصويت.
     · يظهر اسم المتسابق كرابط يوجه إلى خاص المتسابق.
     · يتم تحديث عدد المصوتين للمتسابق.
· ملاحظة: إذا كانت المسابقة للمستخدمين المميزين فقط، يرفض البوت تصويتات المستخدمين العاديين.

---

3.4. قسم مسابقة الأسئلة

3.4.1. زر إنشاء مسابقة قناة:

· تحديد القناة: نفس الآلية السابقة (عرض المضاف مسبقًا أو إضافة جديدة).
· ربط المجموعة: يطلب إضافة البوت مشرفًا في المجموعة المرتبطة وإرسال الرابط.
· إدخال بيانات المسابقة:
  1. إرسال نص كليشة المسابقة.
  2. إرسال عدد الفائزين.
  3. إرسال عدد الأسئلة.
  4. إرسال المدة الزمنية بين انتهاء سؤال وبدء السؤال التالي.
· عرض الملخص والتأكيد:
  · يعرض البوت ملخصًا (الكليشة، عدد الأسئلة، الفاصل الزمني) وزر "تأكيد بدء المسابقة".

آلية مسابقة الأسئلة في القناة:

· مثال: فائزين: 2، أسئلة: 10، فاصل زمني: 30 ثانية.
  1. ينشر البوت السؤال الأول في القناة.
  2. يمكن للمتسابقين الإجابة في تعليقات هذا السؤال خلال 30 ثانية.
  3. أول من يرسل الإجابة الصحيحة ← يحصل على نقطة.
  4. بعد 30 ثانية (أو عند الإجابة الصحيحة) ← ينشر البوت السؤال التالي.
  5. إذا لم يُجب أحد خلال المدة ← يُلغى السؤال وينتقل للذي يليه.
  6. تستمر العملية حتى انتهاء الأسئلة أو عندما ينهي منشئ المسابقة المسابقة يدويًا.
· إنهاء المسابقة وإعلان الفائزين:
  · يعلن البوت عن الفائزين (الأعلى نقاطًا) ويذكر أسماء الباقين مع عدد نقاطهم.

3.4.2. زر مسابقة مجموعة:

· نفس خطوات مسابقة القناة، ولكن:
  · تنشر كليشة المسابقة في المجموعة وتُثبَّت.
  · تُنشر الأسئلة في المجموعة ويُثبَّت كل سؤال.
  · أول مستخدم يرسل الإجابة الصحيحة في المجموعة ← يخبره البوت ويُنقل للسؤال التالي.

ملاحظات هامة لمسابقة الأسئلة:

· عند بدء المسابقة، تُنشر الكليشة مع زرين شفافين خاصين بمنشئ المسابقة فقط:
  · زر إيقاف مؤقت.
  · زر إعلان الفائزين.
· يحسب البوت نقاط الإجابات الصحيحة بدقة.
· لا يكرر البوت نفس السؤال في المسابقة الواحدة.
· إضافة الأسئلة: تتم عبر لوحة الأدمن (سيتم شرحها لاحقًا).

---

3.5. قسم إدارة المجموعات أو القنوات المضافة

· يعرض قائمة المجموعات والقنوات التي ربطها المستخدم بالبوت كأزرار شفافة.
· عند الضغط على زر إحداها:
  · يطلب البوت تأكيد الحذف.
  · إذا تم التأكيد ← يفك البوت الربط ويزيلها من القائمة.

---

3.6. قسم إدارة الاشتراك

· يعرض معلومات اشتراك المستخدم الحالية (النوع، المدة، تاريخ الانتهاء، إلخ).

---

3.7. قسم إدارة سحوباتي ومسابقاتي

· ينقسم إلى قسمين:
  1. سحوباتي: إدارة السحوبات التي أنشأها المستخدم.
  2. مسابقاتي: إدارة المسابقات التي أنشأها المستخدم.
· ملاحظة: تبقى هذه الأقسام كما هي مع بعض التعديلات الإضافية لتناسب الإضافات الجديدة.

---

3.8. قسم كسب النقاط

· يعرض رابط الإحالة الخاص بالمستخدم، بصيغة:
  ```
  https://t.me/يوزر_البوت?start=ايدي_المستخدم
  ```
  مثال: https://t.me/R57?start=985612253
· ملاحظات:
  · يمكن لمالك البوت تعطيل/تفعيل نظام الإحالة عبر لوحة التحكم.
  · يمكنه تحديد عدد النقاط التي يربحها المستخدم عند انضمام أحد عبر رابط دعوته.
  · يمكن للمستخدمين استخدام نقاطهم لدفع اشتراك البوت.

---

4. لوحة تحكم الأدمن (مالك البوت)

تظهر عند إرسال الأمر /admin، وتحتوي على الأقسام الحالية مع الإضافات والتعديلات التالية:

4.1. قسم إدارة الدفع للخدمات المميزة:

· إدارة الدفع للروليت:
  · قسم تعطيل/تفعيل الدفع.
  · قسم تعيين سعر الاشتراك (مرة واحدة / شهري).
· إدارة الدفع للمسابقات:
  · قسم تعطيل/تفعيل الدفع.
  · قسم تعيين سعر الاشتراك (مرة واحدة / شهري).

4.2. قسم إضافة/حذف أسئلة (لمسابقة الأسئلة):

· إضافة أسئلة عبر ملف: رفع ملف يحتوي على الأسئلة.
· إضافة أسئلة نصية: إدخال الأسئلة يدويًا.
· حذف سؤال معين: اختيار سؤال محدد وحذفه.
· ملاحظة مهمة: بعض الأسئلة قد تحتوي على إجابات متعددة تحمل نفس المعنى. مثال:
  · س: أول شخص يرسل الأرقام مرتبة من الواحد إلى تسعة.
  · إجابات صحيحة:
    · 0123456789
    · 0 1 2 3 4 5 6 7 8 9
    · ٠١٢٣٤٥٦٧٨٩
    · ٠ ١ ٢ ٣ ٤ ٥ ٦ ٧ ٨ ٩

---

ملخص عام

هذا البوت يقدم نظامًا متكاملاً لإدارة السحوبات (الروليت) والمسابقات بأنواعها (التصويت، "يستحق"، الأسئلة) مع دعم متقدم للشروط والتخصيصات. كما يدعم نظام اشتراك مميز، ونظام نقاط وإحالة، ولوحة تحكم شاملة للأدمن.

تم شرح كل آلية بدقة وتفصيل، مع الإشارة إلى الإعدادات الافتراضية والسلوك في الحالات المختلفة. هذا الشرح شامل وكامل ومرتب لتسهيل عملية البرمجة دون أي نقصان في المتطلبات.